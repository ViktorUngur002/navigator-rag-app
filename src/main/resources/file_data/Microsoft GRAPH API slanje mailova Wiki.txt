h1. Microsoft Graph API slanje mejlova

Kako bi *Business Navigator* mogao da šalje mejlove preko Microsoft 365 koristeći OAuth, neophodno je da se uradi sledeće:

h2. 1. Kreiranje nove aplikacije

* Korisnik sa *administratorskim pravima* se prijavi na "Azure Portal":https://portal.azure.com
* Kreira novu aplikaciju u *Azure Active Directory*:
** App registrations
** New registration
** Register
* Nakon kreiranja aplikacije, bićete preusmereni na *Overview* stranicu za vašu novu aplikaciju
** Odatle možete da vidite vaše:
*** @Application (Client) ID@
*** @Directory (Tenant) ID@
** Ove vrednosti je potrebno da nam dostavite

h2. 2. Kreiranje Client Secret-a

* Idite na *Certificates & secrets*
* U sekciji *Client secrets*, kliknite na *New client secret*
* Unesite opis i izaberite rok isteka  
_(VAŽNO: potrebno je da nam dostavite i datum isteka secret-a)_
* Kliknite *Add*
* Kopirajte vrednost odmah – to je @Client Secret@ koji je potrebno da nam dostavite, zajedno sa @Client ID@, @Tenant ID@ i datumom isteka  

p{color:red}. *NAPOMENA:* Vrednost @Client Secret@ moguće je videti *samo odmah nakon kreiranja*. Obavezno je kopirati i sačuvati na sigurno mesto.

h2. 3. Davanje dozvola aplikaciji

* Idite na *API permissions*
* Kliknite *Add a permission*
* Izaberite *Microsoft Graph*
* Odaberite *Application permissions*
* U sekciji *Mail* izaberite *Mail.Send*
* Kliknite *Add permissions*
* Kliknite *Grant admin consent for <ORGANIZATION>* i potvrdite

h2. 4. Potrebno sačuvati

Nakon uspešno izvršenih koraka, posedovaćete sledeće informacije:

* @Tenant ID@
* @Client ID@
* @Client Secret@
* Datum isteka @Client Secret@

h2. 5. Unošenje parametara u Business Navigator

* U *Business Navigator* pređite u modul *Administracija*, zatim na cvor *Podesavanja*
* U polju za pretragu ukucajte *microsoft_mail*
* Pojaviće se sledećih 5 parametara koje je potrebno popuniti:
** @microsoft_mail_oauth_client_id@
** @microsoft_mail_oauth_tenant_id@
** @microsoft_mail_oauth_client_secret@
** @microsoft_mail_oauth_client_secret_expiration@
** @microsoft_mail_oauth_username@
* U odgovarajuća polja unesite vrednosti koje ste prethodno dobili prilikom kreiranja aplikacije u Azure portalu.